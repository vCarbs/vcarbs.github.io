<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Bootstrapping the Chef Windows Client Through vCenter Orchestrator" /><meta name="author" content="Nick Carbone" /><meta property="og:locale" content="en_US" /><meta name="description" content="Over the past few weeks, our team has been talking internally about Configuration Management and why we need to get it implemented. This is an important step in the evolution of our IT Infrastructure Management and is something that every serious shop should consider. We have a ton of deployment scripts written in PowerShell, however we had no way to track Configuration Drift and have succumbed to the Snowflake Syndrome. We had initially started looking at vCenter Configuration Manager, but ultimately decided against it due to the lack of documentation and community support. We knew that the engineers who oversee the linux environment are using Chef, and after a two hour conversation, we took a serious look at that option. At this point, we’ve written a few Cookbooks that specifically address MSSQL and IIS, as these are the two types of environments we needed to get into Configuration Management first. With that being said, the need to automate the bootstrap process of the Chef client also presented itself, and what better way to accomplish that then through vCO!" /><meta property="og:description" content="Over the past few weeks, our team has been talking internally about Configuration Management and why we need to get it implemented. This is an important step in the evolution of our IT Infrastructure Management and is something that every serious shop should consider. We have a ton of deployment scripts written in PowerShell, however we had no way to track Configuration Drift and have succumbed to the Snowflake Syndrome. We had initially started looking at vCenter Configuration Manager, but ultimately decided against it due to the lack of documentation and community support. We knew that the engineers who oversee the linux environment are using Chef, and after a two hour conversation, we took a serious look at that option. At this point, we’ve written a few Cookbooks that specifically address MSSQL and IIS, as these are the two types of environments we needed to get into Configuration Management first. With that being said, the need to automate the bootstrap process of the Chef client also presented itself, and what better way to accomplish that then through vCO!" /><link rel="canonical" href="/posts/vCO-Chef-Bootstrap/" /><meta property="og:url" content="/posts/vCO-Chef-Bootstrap/" /><meta property="og:site_name" content="vCarbs.com" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2015-01-23T00:00:00-08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Bootstrapping the Chef Windows Client Through vCenter Orchestrator" /><meta name="twitter:site" content="@vCarbs_" /><meta name="twitter:creator" content="@Nick Carbone" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Nick Carbone"},"description":"Over the past few weeks, our team has been talking internally about Configuration Management and why we need to get it implemented. This is an important step in the evolution of our IT Infrastructure Management and is something that every serious shop should consider. We have a ton of deployment scripts written in PowerShell, however we had no way to track Configuration Drift and have succumbed to the Snowflake Syndrome. We had initially started looking at vCenter Configuration Manager, but ultimately decided against it due to the lack of documentation and community support. We knew that the engineers who oversee the linux environment are using Chef, and after a two hour conversation, we took a serious look at that option. At this point, we’ve written a few Cookbooks that specifically address MSSQL and IIS, as these are the two types of environments we needed to get into Configuration Management first. With that being said, the need to automate the bootstrap process of the Chef client also presented itself, and what better way to accomplish that then through vCO!","url":"/posts/vCO-Chef-Bootstrap/","@type":"BlogPosting","headline":"Bootstrapping the Chef Windows Client Through vCenter Orchestrator","dateModified":"2015-01-23T00:00:00-08:00","datePublished":"2015-01-23T00:00:00-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/vCO-Chef-Bootstrap/"},"@context":"https://schema.org"}</script><title>Bootstrapping the Chef Windows Client Through vCenter Orchestrator | vCarbs.com</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-6WZD9ZS36K"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-6WZD9ZS36K'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="http://vcarbs.com/wp-content/uploads/2019/01/cropped-IMG_0726.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-subtitle mt-3"> <a href="/">vCarbs.com</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/vCarbs" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/vCarbs_" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['nick','vcarbs.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Bootstrapping the Chef Windows Client Through vCenter Orchestrator</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Bootstrapping the Chef Windows Client Through vCenter Orchestrator</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jan 23, 2015, 12:00 AM -0800" > Jan 23, 2015 <i class="unloaded">2015-01-23T00:00:00-08:00</i> </span> by <span class="author"> Nick Carbone </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="978 words">5 min</span></div></div><div class="post-content"><p>Over the past few weeks, our team has been talking internally about Configuration Management and why we need to get it implemented. This is an important step in the evolution of our IT Infrastructure Management and is something that every serious shop should consider. We have a ton of deployment scripts written in PowerShell, however we had no way to track Configuration Drift and have succumbed to the Snowflake Syndrome. We had initially started looking at vCenter Configuration Manager, but ultimately decided against it due to the lack of documentation and community support. We knew that the engineers who oversee the linux environment are using Chef, and after a two hour conversation, we took a serious look at that option. At this point, we’ve written a few Cookbooks that specifically address MSSQL and IIS, as these are the two types of environments we needed to get into Configuration Management first. With that being said, the need to automate the bootstrap process of the Chef client also presented itself, and what better way to accomplish that then through vCO!</p><p><br /> First, we need to setup our PowerShell Host with the Chef Development Kit. I am going to provide a very high level overview of setting up a Chef workstation, in this case it’s our PowerShell Host used by vCenter Orchestrator. If you have not done so already, follow the documentation to get a PowerShell Host setup in vCO as well as setup a Chef workstation node. <a href="http://docs.chef.io/devkit/install_dk.html">ChefDK Documentation</a> &amp; <a href="http://blogs.vmware.com/orchestrator/2011/12/vco-powershell-plug-in.html">vCO PowerShell Host</a></p><p>. Download and install the Chef Development Kit on your PowerShell Host</p><p>. Once we have the Chef Development Kit installed, we need to install the knife-windows gem.</p><p>. In PowerShell or a Command Prompt navigate to the following directory: C:\opscode\chefdk\embedded\bin</p><p>. Once we are in the directory, validate that you can run the following command:</p><p><code class="language-plaintext highlighter-rouge">.\gem</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/1.png" alt="Desktop View" class="normal" /></p><p>. We now need to run the following command to install the required knife-windows gem:</p><p><code class="language-plaintext highlighter-rouge">.\gem install knife-windows</code></p><p>. We should now see the package being installed like the below image:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/2.png" alt="Desktop View" class="normal" /></p><p>. Now that we have installed the knife-windows gem, it is time to download our starter kit and create a directory to store our local repo.</p><p>. With that complete, open up PowerShell and navigate to the Chef Repo directory. I am using C:\chef-repo for this example.</p><p>. Let’s validate that we can bootstrap a Windows node by running the following command:</p><p><code class="language-plaintext highlighter-rouge">knife bootstrap windows winrm localhost</code></p><p>. If everything is working we should be prompted with the below message:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/3.png" alt="Desktop View" class="normal" /></p><p>. Finally, it’s time to open up our PowerShell ISE and write the script that will allow us to bootstrap the node. Enter the below snippet of code into your ISE console:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c"># Parameters gathered from vCenter Orchestrator</span><span class="w">
 
</span><span class="kr">param</span><span class="p">(</span><span class="w">
 
</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$vmName</span><span class="p">,</span><span class="w">
 
</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$User</span><span class="p">,</span><span class="w">
 
</span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Password</span><span class="w">
 
</span><span class="p">)</span><span class="w">
 
  
</span><span class="c"># Create a credential store object</span><span class="w">
 
</span><span class="nv">$SecurePassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Convertto-SecureString</span><span class="w"> </span><span class="nt">-String</span><span class="w"> </span><span class="nv">$Password</span><span class="w"> </span><span class="nt">-AsPlainText</span><span class="w"> </span><span class="nt">-force</span><span class="w">
 
</span><span class="nv">$mycred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Management.Automation.PSCredential</span><span class="w"> </span><span class="nv">$User</span><span class="p">,</span><span class="w"> </span><span class="nv">$SecurePassword</span><span class="w">
 
  
 
</span><span class="c"># Set winrm timeout value. Depending on the location of you Chef server it may take a while to download the required packages.</span><span class="w">
 
</span><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nv">$vmName</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="n">set-Item</span><span class="w"> </span><span class="nx">wsman:\localhost\Config\MaxTimeoutms</span><span class="w"> </span><span class="nt">-value</span><span class="w"> </span><span class="s1">'1800000'</span><span class="w"> </span><span class="nt">-force</span><span class="p">}</span><span class="w"> </span><span class="nt">-Credential</span><span class="w"> </span><span class="nv">$mycred</span><span class="w">
 
 
</span><span class="c"># Bootstrap the node with Chef client. We need to launch the knife command from the Chef repo folder.</span><span class="w">
 
</span><span class="n">Set-Location</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"c:\chef-repo"</span><span class="w">
 
</span><span class="o">&amp;</span><span class="w"> </span><span class="n">knife</span><span class="w"> </span><span class="nx">bootstrap</span><span class="w"> </span><span class="nx">windows</span><span class="w"> </span><span class="nx">winrm</span><span class="w"> </span><span class="nv">$vmName</span><span class="w"> </span><span class="nt">-x</span><span class="w"> </span><span class="nv">$User</span><span class="w"> </span><span class="nt">-P</span><span class="w"> </span><span class="nv">$Password</span><span class="w">
</span></pre></table></code></div></div><p>. Save the file to your PowerShell Host as “chef_bootstrap.ps1”. We will be calling this script from vCO later on.</p><p>. Open up vCO and create a new workflow named “Chef Bootstrap”.</p><p>. Drag the the “Scriptable task” object into the workflow.</p><p>. Add the “Invoke an external script” object into the workflow and click on setup:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/4.png" alt="Desktop View" class="normal" /></p><p>. Input the following values:</p><p>. Host: Select the PowerShell host for our environment.</p><p>. externalScript: This is the location of the PowerShell script “chef_bootstrap.ps1”. My value is C:\scripts\chef_bootstrap.ps1</p><p>. arguments: Leave this blank.</p><p>. Click on “promote” to add these values into the workflow.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/5.png" alt="Desktop View" class="normal" /></p><p>. Under the General tab, add the following Attributes:</p><p>. User. We will leave the type as a string and enter in our username.</p><p>. Password. We need to change the type to SecureString and enter in the password for our username.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/6.png" alt="Desktop View" class="normal" /></p><p>. Now under the Inputs tab add a new parameter called “vmName”. Leave the type as a string.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/7.png" alt="Desktop View" class="normal" /></p><p>. Under the Schema tab we need to edit the “Scriptable task” and add the following settings.</p><p>. Bind vmName, User and Password as inputs.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/8.png" alt="Desktop View" class="normal" /></p><p>. Bind arguments as an output.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/9.png" alt="Desktop View" class="normal" /></p><p>. Validate the bindings by looking at the Visual Binding tab.</p><p>. Under the Scripting tab, add in the following lines of code. This will pass through the required parameters to the PowerShell script.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w">     </span><span class="s2">" -vmName "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vmName</span><span class="w"> </span><span class="o">+</span><span class="w">
 
                </span><span class="s2">" -User "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="o">+</span><span class="w">
 
                </span><span class="s2">" -Password '"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"'"</span><span class="w"> </span><span class="p">;</span><span class="w">
</span></pre></table></code></div></div><p>. Close out of this window. It is now time to debug our workflow.</p><p>. Click on the debug button and enter in the hostname of a Windows server you want to bootstrap with the Chef client:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/posts/vco_chef/10.png" alt="Desktop View" class="normal" /></p><p>. If we navigate to our Chef Server, we should see the newly bootstrapped node.</p><p>Although this works, there are errors in the vCO workflow even though the bootstrap process completed successfully. I spent a good amount of time trying to figure this one out and ended up having to rely on an alternate validation solution which I will document in a later blog post. This process has worked well for us as we also provision our servers through a vCO workflow. Ultimately, it is up to you and your team to decide the process and tools that will help you scale, audit, and automate your infrastructure for future needs.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vcenter-orchestrator/" class="post-tag no-text-decoration" >vCenter Orchestrator</a> <a href="/tags/chef/" class="post-tag no-text-decoration" >Chef</a> <a href="/tags/configuration-management/" class="post-tag no-text-decoration" >Configuration Management</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Bootstrapping the Chef Windows Client Through vCenter Orchestrator - vCarbs.com&url=/posts/vCO-Chef-Bootstrap/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=/posts/vCO-Chef-Bootstrap/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/AWS-VMC-App-Modernization-Part3/">VMC on AWS Application Modernization - Part 3</a><li><a href="/posts/AWS-VMC-App-Modernization-Part1/">VMC on AWS Application Modernization - Part 1</a><li><a href="/posts/AWS-VMC-App-Modernization-Part2/">VMC on AWS Application Modernization - Part 2</a><li><a href="/posts/Upgrading-vSphere-Data-Protection/">Upgrading vSphere Data Protection 5.5.6 to 5.8</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vmware/">VMware</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/configuration-management/">Configuration Management</a> <a class="post-tag" href="/tags/rds-on-vmware/">RDS on VMware</a> <a class="post-tag" href="/tags/vmc-on-aws/">VMC on AWS</a> <a class="post-tag" href="/tags/vmc/">VMC</a> <a class="post-tag" href="/tags/chef/">Chef</a> <a class="post-tag" href="/tags/home-lab/">Home Lab</a> <a class="post-tag" href="/tags/vcenter-orchestrator/">vCenter Orchestrator</a> <a class="post-tag" href="/tags/ansible/">Ansible</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/NetApp-Simulator-Chef/"><div class="card-body"> <span class="timeago small" > Feb 15, 2017 <i class="unloaded">2017-02-15T00:00:00-08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Configuring the NetApp Simulator with Chef</h3><div class="text-muted small"><p> Late last year, I decided that I would try to automate the deployment of the NetApp Virtual Simulator. The organization I work for needed a method to easily and consistently deploy the simulator fo...</p></div></div></a></div><div class="card"> <a href="/posts/Ansible-Tower-vSphere-Discovery/"><div class="card-body"> <span class="timeago small" > Feb 7, 2017 <i class="unloaded">2017-02-07T00:00:00-08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ansible Tower & vSphere Dynamic Discovery</h3><div class="text-muted small"><p> It’s a new year, which means it’s time to learn new things! For the past 6 months, I’ve wanted to dive deeper into Ansible as a way to continuously force myself to write code in python. Naturally,...</p></div></div></a></div><div class="card"> <a href="/posts/vCO-Windows-Upgrade/"><div class="card-body"> <span class="timeago small" > Feb 27, 2015 <i class="unloaded">2015-02-27T00:00:00-08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>vCenter Orchestrator Windows Upgrade</h3><div class="text-muted small"><p> At the company I work for, we just recently upgraded our vCenter Server from 5.5U1 to 5.5U2. To keep in sync with the versioning we also decided to upgrade our vCenter Orchestrator instance. The pr...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/App-Volumes-SSL-Certs/" class="btn btn-outline-primary"><p>Replacing SSL Certificates for VMware App Volumes</p></a> <a href="/posts/vBrownBag-Lab-Host/" class="btn btn-outline-primary"><p>vBrownBag Lab Host</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/vCarbs_">Nick Carbone</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vmware/">VMware</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/configuration-management/">Configuration Management</a> <a class="post-tag" href="/tags/rds-on-vmware/">RDS on VMware</a> <a class="post-tag" href="/tags/vmc-on-aws/">VMC on AWS</a> <a class="post-tag" href="/tags/vmc/">VMC</a> <a class="post-tag" href="/tags/chef/">Chef</a> <a class="post-tag" href="/tags/home-lab/">Home Lab</a> <a class="post-tag" href="/tags/vcenter-orchestrator/">vCenter Orchestrator</a> <a class="post-tag" href="/tags/ansible/">Ansible</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
